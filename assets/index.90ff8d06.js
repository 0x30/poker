var it=Object.defineProperty,ut=Object.defineProperties;var ct=Object.getOwnPropertyDescriptors;var Fe=Object.getOwnPropertySymbols;var dt=Object.prototype.hasOwnProperty,vt=Object.prototype.propertyIsEnumerable;var re=(e,t,s)=>t in e?it(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,E=(e,t)=>{for(var s in t||(t={}))dt.call(t,s)&&re(e,s,t[s]);if(Fe)for(var s of Fe(t))vt.call(t,s)&&re(e,s,t[s]);return e},w=(e,t)=>ut(e,ct(t));var y=(e,t,s)=>(re(e,typeof t!="symbol"?t+"":t,s),s);import{l as le,r as _,P as Ee,a as G,d as p,o as we,c as n,T as ft,b as ke,e as A,f as g,w as U,v as oe,g as gt,t as ie,F as P,h as mt,i as bt,j as ht,u as Ne}from"./vendor.d01bce31.js";const pt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerpolicy&&(l.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?l.credentials="include":a.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=s(a);fetch(a.href,l)}};pt();const _t=()=>Math.random().toString(32).slice(2),Ct=()=>new Date().getTime().toString(32),ue=()=>`${Ct()}${_t()}`,Be=(e,t)=>{function s(a,l){if(a.length===t){r.push(a);return}l+1>e.length||(s(a.concat(e[l]),l+1),s(a,l+1))}let r=[];return s([],0),r},yt=()=>{const e={};return(t,s)=>{const r=e[t];if(r)return r;const a=s();return e[t]=a,a}},At=function(e){for(var t=0,s=0;s<e.length;s++)t=e.charCodeAt(s)+((t<<5)-t);for(var r="#",s=0;s<3;s++){var a=t>>s*8&255;r+=("00"+a.toString(16)).substr(-2)}return r};var f;(function(e){e[e.Spade=1]="Spade",e[e.Heart=2]="Heart",e[e.Diamond=3]="Diamond",e[e.Club=4]="Club"})(f||(f={}));class Se{constructor(t,s){y(this,"id");y(this,"nikeName");y(this,"host");y(this,"createTime");this.id=ue(),this.nikeName=s,this.host=t,this.createTime=new Date().getTime()}}const I={nikeName:"\u{1FAB5}",id:"wooden",host:"\u6728\u5934\u4EBA\uFF0C\u53EA\u4F1A\u8DF3\u8FC7",createTime:1},Pe={nikeName:"\u{1F916}\uFE0F",id:"robot",host:"\u673A\u5668\u4EBA1",createTime:1},Ie={nikeName:"\u{1F47D}",id:"robot2",host:"\u673A\u5668\u4EBA2",createTime:1},Oe={nikeName:"\u{1F480}",id:"robot3",host:"\u673A\u5668\u4EBA3",createTime:1},ce=e=>Re(e)||k(e),k=e=>e.id===I.id,Re=e=>[Pe.id,Ie.id,Oe.id].includes(e.id);class K{constructor(t,s){y(this,"createTime");y(this,"player");y(this,"cards",[]);this.createTime=performance.now(),this.player=w(E({},t),{cards:void 0}),this.cards=s}}class Me{constructor(t,s){y(this,"id");y(this,"players");y(this,"__isOnline");y(this,"tricks",[]);y(this,"championer");y(this,"autoStart");this.id=ue(),this.players=t,this.autoStart=s}}class h extends Se{constructor(t,s){super(t.host,t.nikeName);y(this,"cards");this.id=t.id,this.cards=s}}const O=le.createInstance({name:"plyers",storeName:"players"}),de=_([]),ve={},Te=(e,t)=>(e==null?void 0:e.id)===(t==null?void 0:t.id),fe=()=>{const e=async()=>{const a=await O.keys(),l=await Promise.all(a.map(o=>O.getItem(o)));de.value=l,de.value.filter(o=>!Object.keys(ve).includes(o.id)).forEach(o=>ve[o.id]=new Ee({concurrency:1}))},t=async a=>{await O.setItem(a.id,a),e()},s=async a=>{await O.removeItem(a.id),delete ve[a.id],e()},r=async()=>{const a=await O.keys();var l=!1;for await(const o of[I,Pe,Ie,Oe])a.includes(o.id)||(l=!0,await O.setItem(o.id,o));l&&e()};return e(),r(),{players:de,addPlayer:t,delPlayer:s}},$e=e=>{var t;return(t=e.nikeName)!=null?t:"\u65E0\u540D\u4E4B\u8F88"},ge=e=>ce(e)?e.nikeName:$e(e).slice(0,1),xt=[f.Club,f.Diamond,f.Heart,f.Spade],Dt=[{color:f.Spade,number:17},{color:f.Heart,number:18}],He={[f.Spade]:"\u9ED1\u6843",[f.Heart]:"\u7EA2\u6843",[f.Diamond]:"\u65B9\u7247",[f.Club]:"\u6885\u82B1"},Ft={[f.Heart]:{3:"\u{1F0B3}",4:"\u{1F0B4}",5:"\u{1F0B5}",6:"\u{1F0B6}",7:"\u{1F0B7}",8:"\u{1F0B8}",9:"\u{1F0B9}",10:"\u{1F0BA}",11:"\u{1F0BB}",12:"\u{1F0BD}",13:"\u{1F0BE}",14:"\u{1F0B1}",16:"\u{1F0B2}",18:"\u5927\u{1F0CF}"},[f.Spade]:{3:"\u{1F0A3}",4:"\u{1F0A4}",5:"\u{1F0A5}",6:"\u{1F0A6}",7:"\u{1F0A7}",8:"\u{1F0A8}",9:"\u{1F0A9}",10:"\u{1F0AA}",11:"\u{1F0AB}",12:"\u{1F0AD}",13:"\u{1F0AE}",14:"\u{1F0A1}",16:"\u{1F0A2}",17:"\u5C0F\u{1F0CF}"},[f.Club]:{3:"\u{1F0D3}",4:"\u{1F0D4}",5:"\u{1F0D5}",6:"\u{1F0D6}",7:"\u{1F0D7}",8:"\u{1F0D8}",9:"\u{1F0D9}",10:"\u{1F0DA}",11:"\u{1F0DB}",12:"\u{1F0DD}",13:"\u{1F0DE}",14:"\u{1F0D1}",16:"\u{1F0D2}"},[f.Diamond]:{3:"\u{1F0C3}",4:"\u{1F0C4}",5:"\u{1F0C5}",6:"\u{1F0C6}",7:"\u{1F0C7}",8:"\u{1F0C8}",9:"\u{1F0C9}",10:"\u{1F0CA}",11:"\u{1F0CB}",12:"\u{1F0CD}",13:"\u{1F0CE}",14:"\u{1F0C1}",16:"\u{1F0C2}"}},Et=e=>Ft[e.color][e.number],S=e=>e==null?void 0:e.sort((t,s)=>s.number-t.number).map(Et).join(""),me={3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"J",12:"Q",13:"K",14:"A",16:"2",17:"JOKER",18:"JOKER"},wt={\u9ED1\u6843:f.Spade,\u7EA2\u6843:f.Heart,\u65B9\u7247:f.Diamond,\u6885\u82B1:f.Club},kt={"3":3,"4":4,"5":5,"6":6,"7":7,"8":8,"9":9,"10":10,J:11,Q:12,K:13,A:14,"2":16,JOKER:17},j=e=>({number:me[e.number],color:He[e.color]}),Nt=e=>e.number==="JOKER"&&e.color==="\u9ED1\u6843"?{number:17,color:f.Spade}:e.number==="JOKER"&&e.color==="\u7EA2\u6843"?{number:18,color:f.Heart}:{number:kt[e.number],color:wt[e.color]},be=e=>(s=>s.number===17||s.number===18?`${f.Heart===s.color?"\u5927":"\u5C0F"}${me[s.number]}`:`${He[s.color]}${me[s.number]}`)(e),Le=[...xt.flatMap(e=>new Array(13).fill(1).map((t,s)=>({color:e,number:s+3}))).map(e=>({color:e.color,number:e.number===15?16:e.number})),...Dt],J=(e,t)=>e.color===t.color&&e.number===t.number,Ge=e=>{const t=e.find(r=>k(r)),s=G.exports.shuffle(Le);if(t){if(q(s.slice(0,8)))return Ge(e);const r=e.filter(a=>!k(a));return[new h(I,s.slice(0,8)),new h(r[0],s.slice(8,31)),new h(r[1],s.slice(31,54))]}else return[new h(e[0],s.slice(0,18)),new h(e[1],s.slice(18,36)),new h(e[2],s.slice(36,54))]},Ue=e=>{const t=e.find(r=>k(r)),s=G.exports.shuffle(Le);if(t){if(q(s.slice(0,8)))return Ue(e);const r=e.filter(a=>!k(a));return[[new h(I,s.slice(0,8)),new h(r[0],s.slice(8,31)),new h(r[1],s.slice(31,54))],[new h(I,s.slice(0,8)),new h(r[1],s.slice(8,31)),new h(r[0],s.slice(31,54))]]}else return[[new h(e[0],s.slice(0,18)),new h(e[1],s.slice(18,36)),new h(e[2],s.slice(36,54))],[new h(e[2],s.slice(0,18)),new h(e[0],s.slice(18,36)),new h(e[1],s.slice(36,54))],[new h(e[1],s.slice(0,18)),new h(e[2],s.slice(18,36)),new h(e[0],s.slice(36,54))]]},Ke={color:f.Diamond,number:3},q=e=>e.findIndex(t=>J(t,Ke))!==-1,he=e=>{const{component:t,enterAnimed:s,leaveAnimed:r}=e,a=document.createElement("div");document.body.appendChild(a);const l=p({props:{close:Function,destory:Function},setup:u=>{var c;const d=_(!1);return(c=u.close)==null||c.call(u,()=>d.value=!1),we(()=>d.value=!0),()=>n(ft,{onEnter:s,onLeave:(v,m)=>{v.style.pointerEvents="none",r?r(v,m):setTimeout(m,10)},onAfterLeave:u.destory},{default:()=>[d.value?t:null]})}});let o=()=>{};const i=ke(n(l,{style:{zIndex:9999},close:u=>o=u,destory:()=>{i.unmount(),document.body.removeChild(a)}},null));return i.mount(a),e.ignorePopupManager!==!0,()=>{e.ignorePopupManager!==!0,o()}},Bt=p({props:{player:{type:Object,required:!0},selectd:Boolean,onClick:Function},setup:e=>()=>{var t;return n("div",{class:`card shadow-lg compact cursor-pointer side ${e.selectd?"bg-primary":"bg-base-100"}`,onClick:()=>{var s;return(s=e.onClick)==null?void 0:s.call(e,e.player)}},[n("div",{class:"flex-row items-center space-x-4 card-body"},[n("div",null,[n("div",{class:"avatar placeholder"},[n("div",{class:"bg-neutral-focus text-neutral-contentx rounded-full w-14 h-14"},[n("span",null,[ge(e.player)])])])]),n("div",null,[n("h2",{class:`card-title ${e.selectd?"text-white":null}`},[$e(e.player)]),n("p",{class:`${e.selectd?"text-white":"text-base-content"} text-opacity-40`},[(t=e.player)==null?void 0:t.host])])])])}}),St=p({props:{onSubmit:Function,onDismiss:Function},setup:e=>{const{players:t}=fe(),s=_(),r=A(()=>{var m;const c=Number.parseInt((m=s.value)!=null?m:"1"),v=Number.isNaN(c)?1:c;return Math.max(1,v)}),a=_(!1),l=_([]),o=c=>l.value.find(v=>v.id===c.id)!==void 0,i=c=>{o(c)?l.value=l.value.filter(v=>v.id!==c.id):l.value.push(c)},u=A(()=>l.value.length>=3),d=()=>{var m;const v=Be(l.value,3).flatMap(C=>new Array(r.value).fill("").map(()=>Ge(C)));(m=e.onSubmit)==null||m.call(e,v.map(C=>new Me(C,a.value)))};return()=>n("div",{class:"modal visible opacity-100 pointer-events-auto"},[n("div",{class:"modal-box "},[n("div",{class:"grid grid-cols-2 gap-3"},[t.value.map(c=>n(Bt,{key:c.id,player:c,selectd:o(c),onClick:v=>i(v)},null))]),n("div",{class:"flex items-center space-x-3"},[n("div",{class:"form-control mt-3 flex-1"},[n("label",{class:"label"},[n("span",{class:"label-text"},[g("\u6BCF\u7EC4\u9009\u624B\u7684\u5BF9\u6218\u6B21\u6570")])]),U(n("input",{type:"number","onUpdate:modelValue":c=>s.value=c,max:10,placeholder:"\u9ED8\u8BA4\u4E00\u6B21\uFF0C\u8BF7\u5C3D\u53EF\u80FD\u7684\u4E0D\u8981\u8D85\u8FC75\u6B21",class:"input input-bordered font-mono"},null),[[oe,s.value]])]),n("div",{class:"form-control mt-3 flex flex-col"},[n("label",{class:"label"},[n("span",{class:"label-text"},[g("\u662F\u5426\u81EA\u52A8\u5F00\u5BF9\u6218")])]),U(n("input",{type:"checkbox","onUpdate:modelValue":c=>a.value=c,class:"toggle toggle-lg self-center"},null),[[gt,a.value]])])]),n("div",{class:"modal-action"},[n("button",{class:"btn btn-primary px-8",disabled:!u.value,onClick:d},[g("\u589E\u52A0")]),n("button",{class:"btn px-8",onClick:e.onDismiss},[g("\u53D6\u6D88")])])])])}}),Pt=()=>new Promise(e=>{const t=he({component:n(St,{onDismiss:()=>t(),onSubmit:s=>{t(),e(s)}},null)})}),T=le.createInstance({driver:le.LOCALSTORAGE,name:"games",storeName:"games"}),pe=_([]),$={},z=()=>{const e=async()=>{const l=await T.keys(),o=await Promise.all(l.map(i=>T.getItem(i)));pe.value=o,pe.value.filter(i=>!Object.keys($).includes(i.id)).forEach(i=>$[i.id]=new Ee({concurrency:1}))},t=async l=>{await Promise.all(l.map(o=>T.setItem(o.id,o))),e()},s=async l=>{await T.removeItem(l.id),delete $[l.id],e()},r=(l,o)=>{var i,u;(i=$[l.id])==null||i.add(o),(u=$[l.id])==null||u.start()},a=async l=>{await r(l,async()=>await T.setItem(l.id,JSON.parse(JSON.stringify(l)))),e()};return e(),{games:pe,addGames:t,delGame:s,updateGame:a}},It=p({props:{onSubmit:{type:Function,required:!0},onDismiss:Function},setup:e=>{const t=_(""),s=_(),r=_(!1),a=()=>{r.value=!0,e.onSubmit(new Se(t.value,s.value))};return()=>n("div",{class:"modal visible opacity-100 pointer-events-auto"},[n("div",{class:"modal-box"},[n("div",{class:"form-control"},[n("label",{class:"label"},[n("span",{class:"label-text"},[g("HOST")])]),U(n("input",{type:"text","onUpdate:modelValue":l=>t.value=l,placeholder:"\u8F93\u5165\u63A5\u53E3\u8BBF\u95EE\u5730\u5740 \u4F8B:192.168.0.1:8080",class:"input input-bordered font-mono"},null),[[oe,t.value]])]),n("div",{class:"form-control"},[n("label",{class:"label"},[n("span",{class:"label-text"},[g("\u7528\u6237\u6635\u79F0")])]),U(n("input",{type:"text","onUpdate:modelValue":l=>s.value=l,placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0(\u53EF\u9009)",class:"input input-bordered font-mono"},null),[[oe,s.value]])]),n("div",{class:"modal-action"},[n("button",{class:`btn btn-primary px-8 ${r.value?"loading":null}`,onClick:a},[g("\u589E\u52A0")]),n("button",{class:"btn px-8",disabled:r.value,onClick:e.onDismiss},[g("\u53D6\u6D88")])])])])}}),Ot=()=>new Promise(e=>{const t=he({component:n(It,{onDismiss:()=>t(),onSubmit:s=>{t(),e(s)}},null)})});var Rt=p(()=>{const{addPlayer:e,players:t}=fe(),{addGames:s}=z(),r=async()=>{const o=A(()=>t.value.filter(c=>!ce(c))),d=Be(o.value,2).map(c=>[...c,I]).flatMap(c=>new Array(1).fill("").flatMap(()=>Ue(c))).map(c=>{const v=new Me(c,!0);return v.__isOnline=!0,v});s(d)},a=async()=>{const o=await Ot();e(o)},l=async()=>{const o=await Pt();s(o)};return()=>n("div",{class:"navbar fixed top-0 right-0 left-0 lg:top-5 lg:right-5 lg:left-5 bg-neutral text-neutral-content lg:rounded-box z-50"},[n("div",{class:"flex-1 px-2 mx-2"},[n("span",{class:"text-lg font-bold"},[g("\u8DD1\u5F97\u5FEB")])]),n("div",null,[n("button",{"data-tip":"\u5F00\u59CB\u6BD4\u8D5B",class:"btn btn-square btn-ghost tooltip flex items-center",onClick:r},[n("i",{class:"gg-trophy"},null)])]),n("div",null,[n("button",{"data-tip":"\u589E\u52A0\u7528\u6237",class:"btn btn-square btn-ghost tooltip flex items-center",onClick:a},[n("i",{class:"gg-user-add"},null)])]),n("div",null,[n("button",{"data-tip":"\u5F00\u5C40\u6E38\u620F",class:"tooltip btn btn-square btn-ghost flex items-center",onClick:l},[n("i",{class:"gg-games"},null)])]),n("div",null,[n("a",{href:"./rule.html",target:"_blank","data-tip":"\u89C4\u5219\u8BF4\u660E",class:"tooltip btn btn-square btn-ghost flex items-center"},[n("i",{class:"gg-info"},null)])])])}),Mt=p(()=>()=>n("footer",{class:"items-center p-4 footer bg-neutral text-neutral-content footer-center col-span-3"},[n("div",{class:"items-center grid-flow-col"},[n("svg",{width:"36",height:"36",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","fill-rule":"evenodd","clip-rule":"evenodd",class:"fill-current"},[n("path",{d:"M22.672 15.226l-2.432.811.841 2.515c.33 1.019-.209 2.127-1.23 2.456-1.15.325-2.148-.321-2.463-1.226l-.84-2.518-5.013 1.677.84 2.517c.391 1.203-.434 2.542-1.831 2.542-.88 0-1.601-.564-1.86-1.314l-.842-2.516-2.431.809c-1.135.328-2.145-.317-2.463-1.229-.329-1.018.211-2.127 1.231-2.456l2.432-.809-1.621-4.823-2.432.808c-1.355.384-2.558-.59-2.558-1.839 0-.817.509-1.582 1.327-1.846l2.433-.809-.842-2.515c-.33-1.02.211-2.129 1.232-2.458 1.02-.329 2.13.209 2.461 1.229l.842 2.515 5.011-1.677-.839-2.517c-.403-1.238.484-2.553 1.843-2.553.819 0 1.585.509 1.85 1.326l.841 2.517 2.431-.81c1.02-.33 2.131.211 2.461 1.229.332 1.018-.21 2.126-1.23 2.456l-2.433.809 1.622 4.823 2.433-.809c1.242-.401 2.557.484 2.557 1.838 0 .819-.51 1.583-1.328 1.847m-8.992-6.428l-5.01 1.675 1.619 4.828 5.011-1.674-1.62-4.829z"},null)]),n("p",null,[g("Copyright \xA9 2021 - All right reserved")])])]));console.log(1638356078611);var je;(function(e){e[e.dan=1]="dan",e[e.dui=2]="dui",e[e.santiao=3]="santiao",e[e.sandaiyi=4]="sandaiyi",e[e.sandaier=5]="sandaier",e[e.danshun=6]="danshun",e[e.shuangshun=7]="shuangshun",e[e.sidaiyi=10]="sidaiyi",e[e.sidaier=11]="sidaier",e[e.zhadan=13]="zhadan"})(je||(je={}));const Q=(e,t)=>e.every((s,r,a)=>s===(t!=null?t:a[0])),Je=e=>e.reduce((t,s)=>{var r;return t[s]=((r=t[s])!=null?r:0)+1,t},{}),qe=e=>{const t=Je(e);return ze(t).map(s=>({number:s,count:t[s]}))},ze=e=>Object.keys(e).map(t=>Number.parseInt(t)),Qe=e=>e.sort((t,s)=>t-s).every((t,s,r)=>{var a;return t===((a=r[s-1])!=null?a:r[0]-1)+1}),V=(e,t)=>{const r=qe(e).find(a=>a.count===t);if(r)return r.number},Ve=(e,t,s)=>{const a=qe(e.filter(l=>l!==t)).find(l=>l.count===s);if(a)return a.number},Tt=(e,t)=>{const s=Je(e);return Qe(ze(s))&&Q(Object.values(s),t)},_e=e=>{if(e.length!==0){if(e.length===1)return{type:1,weight:e[0]};if(e.length===2){if(e.every(t=>[17,18].includes(t)))return{type:13,weight:18};if(Q(e))return{type:2,weight:e[0]}}if(e.length===3&&Q(e))return{type:3,weight:e[0]};if(e.length===4){if(Q(e))return{type:13,weight:e[0]};const t=V(e,3);if(t!==void 0)return{type:4,weight:t}}if(e.length>=5){if(e.length===5){const t=V(e,4);if(t!==void 0)return{type:10,weight:t};const s=V(e,3);if(s!==void 0&&Ve(e,s,2))return{type:5,weight:s}}if(Math.max(...e)<15&&Qe(e))return{type:6,weight:Math.max(...e)}}if(e.length>=6){if(e.length===6){const t=V(e,4);if(t!==void 0&&Ve(e,t,2))return{type:11,weight:t}}if(Tt(e,2))return{type:7,weight:Math.max(...e)}}}},$t=(e,t,s)=>{const r=_e(e),a=_e(t);if(!(a===void 0||r===void 0)){if(a.type===13)return r.type===13?a.weight>r.weight:!0;if(e.length===t.length&&a.type===r.type)return a.weight>r.weight}},We=e=>_e(e.map(t=>t.number)),Ht=(e,t,s)=>$t(e.map(r=>r.number),t.map(r=>r.number));var b;(function(e){e[e.dan=1]="dan",e[e.dui=2]="dui",e[e.santiao=3]="santiao",e[e.sandaiyi=4]="sandaiyi",e[e.sandaier=5]="sandaier",e[e.danshun=6]="danshun",e[e.shuangshun=7]="shuangshun",e[e.sidaiyi=10]="sidaiyi",e[e.sidaier=11]="sidaier",e[e.zhadan=13]="zhadan"})(b||(b={}));var H;(function(e){e[e.Spade=1]="Spade",e[e.Heart=2]="Heart",e[e.Diamond=3]="Diamond",e[e.Club=4]="Club"})(H||(H={}));const W=(e,t)=>{const s=t!=null?t:e[0];return e.every(r=>r===s)},X=e=>e.reduce((t,s)=>{var r;return t[s]=((r=t[s])!=null?r:0)+1,t},{}),Lt=e=>{const t=X(e);return Xe(t).map(s=>({number:s,count:t[s]}))},Xe=e=>Object.keys(e).map(t=>Number.parseInt(t)),Ce=e=>e.every((t,s,r)=>{var a;return t===((a=r[s-1])!=null?a:r[0]-1)+1}),Ye=e=>e.sorted===!0?e:(e.sorted=!0,e.slice().sort((t,s)=>t.number-s.number));H.Diamond;const Gt=[{color:H.Spade,number:17},{color:H.Heart,number:18}],Y=(e,t)=>{const s=Object.entries(X(e)).find(([r,a])=>a===t);if(s)return Number.parseInt(s[0])},Ze=(e,t,s)=>{const a=Lt(e.filter(l=>l!==t)).find(l=>l.count===s);if(a)return a.number},Ut=(e,t)=>{const s=X(e);return Ce(Xe(s))&&W(Object.values(s),t)},Kt=e=>{if(e.length!==0){if(e.length===1)return[b.dan,e[0]];if(e.length===2){if(e.toString()==="17,18")return[b.zhadan,18];if(W(e))return[b.dui,e[0]]}if(e.length===3&&W(e))return[b.santiao,e[0]];if(e.length===4){if(W(e))return[b.zhadan,e[0]];const t=Y(e,3);if(t)return[b.sandaiyi,t]}if(e.length>=5){if(e.length===5){const t=Y(e,3);if(t&&Ze(e,t,2))return[b.sandaier,t];const s=Y(e,4);if(s)return[b.sidaiyi,s]}if(Ce(e))return[b.danshun,Math.max(...e)]}if(e.length>=6){if(e.length===6){const t=Y(e,4);if(t&&Ze(e,t,2))return[b.sidaier,t]}if(Ut(e,2))return[b.shuangshun,Math.max(...e)]}}},jt=e=>{const t=Kt(Ye(e).map(a=>a.number));if(t===void 0)return;const[s,r]=t;return{cards:e,type:s,weight:r}},ye=e=>e.map(t=>t.number.toString(32)).join(""),Jt=e=>{const t=new Set,s=[];for(const r of e){const a=ye(r);t.has(a)===!1&&(t.add(a),s.push(r))}return s},et=(e,t)=>{var a;const s=new RegExp(`(\\w)${"\\1".repeat(t-1)}`,"g");return((a=ye(e).match(s))!=null?a:[]).map(l=>e.filter(o=>o.number===Number.parseInt(l.substr(0,1),32)).slice(0,t))},Z=(e,t,s,r)=>(()=>{const l=r?e.filter(d=>d.number!==r):e,o=Object.entries(X(l.map(d=>d.number))),i=o.filter(([d,c])=>Number.parseInt(d)>s&&c===t);if(i.length>0)return i.map(([d])=>e.filter(c=>c.number===Number.parseInt(d)));const u=o.filter(([d,c])=>Number.parseInt(d)>s&&c>t);return u.length>0?u.map(([d])=>e.filter(c=>c.number===Number.parseInt(d)).slice(0,t)):[]})().sort((l,o)=>l[0].number-o[0].number),ee=(e,t,s,r)=>{const a=Z(e,t,s);if(a.length<=0)return[];const l=a.flatMap(o=>Z(e,r,0,o[0].number));return l.length<=0?[]:a.map(o=>[...o,...l[0]])},qt=(e,t,s)=>t.filter(r=>r.number===e).slice(0,s),zt=e=>/hi/.test(ye(e))?[Gt]:[],tt=(e,t,s)=>{const r=[],a=s.filter(l=>r.includes(l.number)?!1:l.number>t-e+1&&l.number<15?(r.push(l.number),!0):!1);return a.length<e?[]:new Array(a.length-e+1).fill(0).map((l,o)=>a.slice(o,o+e)).filter(l=>Ce(l.map(o=>o.number)))},Qt=(e,t,s,r)=>{const a=et(s,r).filter(o=>o[0].number>t-e/r);if(a.length<e/r)return[];const l=a.flatMap(o=>o);return tt(e/r,t,l).map(o=>o.reduce((i,u)=>[...i,...qt(u.number,l,2)],[]))},Vt=(e,t)=>{const s=jt(e);if(s===void 0)return[];const r=Ye(t),a=[...zt(r),...et(r,4).filter(o=>s.type===b.zhadan?o[0].number>s.weight:!0)];return t.length<e.length?a:[...Jt((()=>{switch(s.type){case b.dan:return r.filter(o=>o.number>s.weight).map(o=>[o]);case b.dui:return Z(r,2,s.weight);case b.santiao:return Z(r,3,s.weight);case b.sandaiyi:return ee(r,3,s.weight,1);case b.sandaier:return ee(r,3,s.weight,2);case b.danshun:return tt(e.length,s.weight,r);case b.shuangshun:return Qt(e.length,s.weight,r,2);case b.sidaier:return ee(r,4,s.weight,2);case b.sidaiyi:return ee(r,4,s.weight,1);case b.zhadan:break}return[]})()),...a]},Wt=e=>(()=>{const s=M(e);if(s===void 0&&e.tricks.length===0)return[[{color:f.Diamond,number:3}]];const r=ne(e),a=se(e,r);return s===void 0?[a.sort((l,o)=>l.number-o.number).slice(0,1)]:Vt(s.cards,a)})().map(s=>w(E({},We(s)),{cards:s})),Xt=yt(),st=e=>{const t=e.id,s=e.tricks.length,r=e.tricks.reduce((l,o)=>l+o.tricks.length,0),a=`${t}${s}${r}`;return Xt(a,()=>Wt(e).sort((l,o)=>l.type*10+l.weight-(o.type*10+o.weight)))},nt=e=>{var t;return(t=st(e)[0])==null?void 0:t.cards};function te(){return new Worker("./assets/reqWorker.f58fd3cf.js",{type:"module"})}const Yt=[new te,new te,new te,new te],Zt=(e,t)=>`http://${e.host}${t}`,es=(e,t)=>{const s=G.exports.sample(Yt);return new Promise(r=>{const a=ue(),l=o=>{o.data.id===a&&(s==null||s.removeEventListener("message",l),r(o.data.res))};s==null||s.addEventListener("message",l),s==null||s.postMessage({id:a,url:e,params:t})})},ts=(e,t,s)=>{const r=s===void 0?void 0:{body:JSON.stringify(w(E({},s),{player:w(E({},e),{cards:e.cards.map(j)})})),headers:{"content-type":"application/json"},method:"POST"};return es(Zt(e,t),w(E({},r),{mode:"cors"}))},ss=e=>{var a;const t=ne(e);if(k(t))return Promise.resolve(new K(t,void 0));if(Re(t))return Promise.resolve(new K(t,nt(e)));const s=()=>e.tricks.sort((o,i)=>o.idx-i.idx).flatMap(o=>o.tricks.sort((i,u)=>i.createTime-u.createTime)).map(o=>{var i;return w(E({},o),{player:w(E({},o.player),{leftCards:void 0}),cards:(i=o.cards)==null?void 0:i.map(j)})}),r=()=>{var o;const l=M(e);return w(E({},l),{cards:(o=l==null?void 0:l.cards)==null?void 0:o.map(j)})};return ts(t,"/ask",{gameId:e.id,history:s(),tips:e.__isOnline===!0?[]:(a=nt(e))==null?void 0:a.map(l=>j(l)),needHandleTrick:r()}).then(l=>{var i,u;let o;return((i=l.data)==null?void 0:i.length)>0&&(o=(u=l.data)==null?void 0:u.map(Nt)),new K(t,o)})},R=e=>e.tricks.sort((t,s)=>s.idx-t.idx)[0].tricks.sort((t,s)=>s.createTime-t.createTime),M=e=>{var s,r;if(e.tricks.length===0)return;const t=R(e);if(!(((s=t==null?void 0:t.length)!=null?s:0)>2&&((r=t==null?void 0:t.slice(0,2))==null?void 0:r.every(a=>a.cards===void 0))===!0))return t==null?void 0:t.find(a=>a.cards!==void 0)},se=(e,t)=>{const s=e.tricks.flatMap(a=>a.tricks.map(l=>l)).filter(a=>a.player.id===t.id&&a.cards!==void 0).flatMap(a=>a.cards);return e.players.find(a=>a.id===t.id).cards.filter(a=>s.find(l=>J(l,a))===void 0)},ns=(e,t)=>{const s=M(e);if(s===void 0){if(t.cards===void 0)throw new Error("\u6D41\u7A0B\u9519\u8BEF,\u672C\u6B21\u5FC5\u987B\u51FA\u724C");if(e.tricks.length===0&&q(t.cards)===!1)throw console.log("======================================"),console.log(`%c${S(t.cards)}`,"font-size: 100px"),new Error(`\u724C\u578B\u9519\u8BEF,\u9996\u6B21\u51FA\u724C\u4E2D\u5FC5\u987B\u5305\u542B${be(Ke)}`)}if(t.cards===void 0)return t;if(We(t.cards)===void 0)throw console.log("======================================"),console.log(`%c${S(t.cards)}`,"font-size: 100px"),new Error("\u51FA\u724C\u89C4\u5219\u9519\u8BEF");if(new Set(t.cards.map(be)).size!==t.cards.length)throw console.log("======================================"),console.log(`%c${S(t.cards)}`,"font-size: 100px"),new Error("\u4F60\u51FA\u5F97\u724C\u4E0D\u592A\u5BF9\u52B2");const r=se(e,t.player);if(t.cards.every(a=>r.find(l=>J(l,a))!==void 0)===!1)throw console.log("======================================"),console.log(`\u5269\u4F59\u5361\u6C60: %c${S(r)}`,"font-size: 100px"),console.log(`\u5F53\u524D\u5361\u7EC4: %c${S(t.cards)}`,"font-size: 100px"),new Error("\u5361\u724C\u4E0D\u5168\uFF0C\u8BF7\u68C0\u67E5");if((s==null?void 0:s.cards)===void 0||Ht(s.cards,t.cards,r.length===t.cards.length))return t;throw console.log("======================================"),console.log(`\u5BF9\u624B\u5361\u7EC4: %c${S(s.cards)}`,"font-size: 100px"),console.log(`\u5F53\u524D\u5361\u7EC4: %c${S(t.cards)}`,"font-size: 100px"),new Error("\u51FA\u5F97\u724C\u4E0D\u592A\u5BF9\u52B2\uFF0C\u4E0D\u662F\u6253\u4E0D\u9519\uFF0C\u5C31\u662F\u7C7B\u578B\u5927\u592A\u642D")},as=(e,t)=>se(e,t).length===0,ne=e=>{var a,l;const t=e.players.sort((o,i)=>o.createTime-i.createTime);if(e.tricks.length===0)return t.find(o=>q(o.cards));if(M(e)===void 0){const o=(a=R(e))==null?void 0:a.slice(2,3)[0].player.id;return t.find(i=>i.id===o)}const s=(l=R(e))==null?void 0:l[0].player,r=t.findIndex(o=>o.id===(s==null?void 0:s.id));return t[(r+2)%3]},rs=(e,t)=>{var s;if(e.tricks.length!==0)return(s=R(e))==null?void 0:s.find(r=>r.player.id===t.id)},ls=e=>{const t=ne(e);return e.players.map(s=>w(E({},s),{lastTrick:rs(e,s),currentPlayer:t.id===s.id,leftCards:se(e,s)}))},at={},os=e=>{const t=_(e),{updateGame:s}=z(),r=_(!1),a=()=>{e.autoStart=!e.autoStart,e.autoStart===!0&&d(),s(e)},l=async()=>{e.championer===void 0&&e.autoStart===!0&&d()},o=(v,m)=>{const C=new K(v,m);c(C)},i=()=>{e.championer=void 0,e.tricks=[],e.autoStart=!1,ie(t),s(e)},u=()=>{const v=JSON.parse(JSON.stringify(t.value)),m=R(v),C=m==null?void 0:m.shift();(C==null?void 0:C.player)&&k(C.player)&&(m==null||m.shift()),v.tricks=v.tricks.filter(D=>D.tricks.length>0),t.value=v,ie(t),s(v)},d=async()=>{if(e.championer===void 0)try{r.value=!0;const v=await ss(e);r.value=!1,c(v),e.autoStart===!0&&d()}catch{r.value=!1}},c=v=>{var C;const m=M(e);try{const D=ns(e,v);if(m===void 0)D.createTime=0,e.tricks.push({idx:e.tricks.length,tricks:[D]});else{const N=R(e);v.createTime=((C=N==null?void 0:N.length)!=null?C:0)+1,N==null||N.push(v)}as(e,v.player)&&(e.championer=v.player),t.value=e,ie(t),s(e)}catch(D){throw console.error(D),D}};return l(),{trashTricks:i,cancelTrick:u,isAsking:r,gameRef:t,toggle:a,moveCursor:d,manualPlay:o}},Ae=e=>{const t=at[e.id];if(t)return t;const s=os(e);return at[e.id]=s,s};var is="./assets/CLUB-1.6c04b83a.svg",us="./assets/CLUB-10.ff336871.svg",cs="./assets/CLUB-11-JACK.9440ee79.svg",ds="./assets/CLUB-12-QUEEN.42967745.svg",vs="./assets/CLUB-13-KING.1e38afeb.svg",fs="./assets/CLUB-2.66b3516d.svg",gs="./assets/CLUB-3.70acee24.svg",ms="./assets/CLUB-4.c94b66ed.svg",bs="./assets/CLUB-5.62f45f9d.svg",hs="./assets/CLUB-6.a409fcb5.svg",ps="./assets/CLUB-7.7ea958d4.svg",_s="./assets/CLUB-8.fd82e59d.svg",Cs="./assets/CLUB-9.f1ea3878.svg",ys="./assets/DIAMOND-1.b11c3a25.svg",As="./assets/DIAMOND-10.0bebcd7d.svg",xs="./assets/DIAMOND-11-JACK.74a397d0.svg",Ds="./assets/DIAMOND-12-QUEEN.938acd20.svg",Fs="./assets/DIAMOND-13-KING.1744b9af.svg",Es="./assets/DIAMOND-2.98c3b419.svg",ws="./assets/DIAMOND-3.99e3d7ea.svg",ks="./assets/DIAMOND-4.5bc4b299.svg",Ns="./assets/DIAMOND-5.e3b63634.svg",Bs="./assets/DIAMOND-6.1ef2ea4e.svg",Ss="./assets/DIAMOND-7.4b5ed584.svg",Ps="./assets/DIAMOND-8.d962e49d.svg",Is="./assets/DIAMOND-9.d6eabe50.svg",Os="./assets/HEART-1.86e1dae7.svg",Rs="./assets/HEART-10.3259f8c9.svg",Ms="./assets/HEART-11-JACK.bb321f82.svg",Ts="./assets/HEART-12-QUEEN.5ce9d25d.svg",$s="./assets/HEART-13-KING.0ec42659.svg",Hs="./assets/HEART-2.64c45b3e.svg",Ls="./assets/HEART-3.8f39dfba.svg",Gs="./assets/HEART-4.eb9ccf37.svg",Us="./assets/HEART-5.efd88547.svg",Ks="./assets/HEART-6.454c8ac7.svg",js="./assets/HEART-7.9983e499.svg",Js="./assets/HEART-8.21db4aa6.svg",qs="./assets/HEART-9.1150424a.svg",zs="./assets/JOKER-1.67158a3f.svg",Qs="./assets/JOKER-2.65afd483.svg",Vs="./assets/JOKER-3.5b8fb4b5.svg",Ws="./assets/SPADE-1.d274588c.svg",Xs="./assets/SPADE-10.6e1cf64c.svg",Ys="./assets/SPADE-11-JACK.47b9ba5d.svg",Zs="./assets/SPADE-12-QUEEN.a1634915.svg",en="./assets/SPADE-13-KING.4444a319.svg",tn="./assets/SPADE-2.b5e82fff.svg",sn="./assets/SPADE-3.4a990d4b.svg",nn="./assets/SPADE-4.66f0bed0.svg",an="./assets/SPADE-5.f9cb7134.svg",rn="./assets/SPADE-6.3e391204.svg",ln="./assets/SPADE-7.9a06b421.svg",on="./assets/SPADE-8.03465a9b.svg",un="./assets/SPADE-9.609b602d.svg";const cn=p({props:{isAsking:Boolean,isPlaying:Boolean,isFinish:Boolean,isCanCancel:Boolean,isTrash:Boolean,onDelGame:Function,onTrash:Function,onCancel:Function,onClose:Function,onToggle:Function,onGoDetail:Function,onNext:Function},setup:e=>()=>n("div",{class:"btn-group"},[(()=>{const s=[];return e.isAsking===!1&&e.onDelGame&&s.push(n("button",{"data-tip":"\u5220\u9664\u6E38\u620F",class:"tooltip btn btn-outline btn-sm px-5",onClick:e.onDelGame},[n("i",{class:"gg-trash"},null)])),e.onTrash&&s.push(n("button",{disabled:e.isCanCancel===!1,"data-tip":"\u79FB\u9664\u5168\u90E8\u64CD\u4F5C",class:"tooltip btn btn-outline btn-sm",onClick:e.onTrash},[n("i",{class:"gg-undo"},null)])),e.onCancel&&s.push(n("button",{disabled:e.isCanCancel===!1,class:"btn btn-outline btn-sm",onClick:e.onCancel},[n("i",{class:"gg-mail-reply"},null)])),s})(),e.onGoDetail&&(e.isPlaying===!1||e.isFinish)?n("button",{"data-tip":"\u67E5\u770B\u8BE6\u60C5",class:"tooltip btn btn-outline btn-sm",onClick:e.onGoDetail},[n("i",{class:"gg-eye transform "},null)]):null,e.isFinish||e.isPlaying||e.onNext===void 0?null:n(P,null,[n("button",{"data-tip":"\u5F53\u524D\u7528\u6237\u6267\u884C\u51FA\u724C\u903B\u8F91",class:`btn btn-outline btn-sm tooltip px-5 ${e.isAsking?"loading":""}`,onClick:e.onNext},[n("i",{class:"gg-play-track-next transform "},null)])]),e.onClose?n("button",{class:"btn btn-sm btn-outline",onClick:e.onClose},[n("i",{class:"gg-close"},null)]):null])}),dn=p({props:{isAsking:Boolean,isPlaying:Boolean,isFinish:Boolean,isCanCancel:Boolean,isTrash:Boolean,onDelGame:Function,onTrash:Function,onCancel:Function,onClose:Function,onToggle:Function,onGoDetail:Function,onNext:Function},setup:e=>()=>n(P,null,[(()=>{const s=[];return e.isAsking===!1&&e.onDelGame&&s.push(n("button",{class:"btn btn-sm btn-square px-5",onClick:e.onDelGame},[n("i",{class:"gg-trash"},null)])),e.isFinish===!1&&e.isPlaying===!1&&e.isAsking===!1&&(e.onTrash&&s.push(n("button",{disabled:e.isCanCancel===!1,class:"btn btn-sm btn-square",onClick:e.onTrash},[n("i",{class:"gg-undo"},null)])),e.onCancel&&s.push(n("button",{disabled:e.isCanCancel===!1,class:"btn btn-sm btn-square",onClick:e.onCancel},[n("i",{class:"gg-mail-reply"},null)]))),s})(),e.isFinish===!1&&e.onToggle?n("button",{class:`btn btn-sm btn-square ${e.isPlaying?"btn-active":""}`,onClick:e.onToggle},[e.isPlaying?n("i",{class:"gg-play-pause transform "},null):n("i",{class:"gg-play-button transform "},null)]):null,e.onGoDetail&&(e.isPlaying===!1||e.isFinish)?n("button",{class:"btn btn-sm btn-square",onClick:e.onGoDetail},[n("i",{class:"gg-eye transform "},null)]):null,e.isFinish||e.isPlaying||e.onNext===void 0?null:n(P,null,[n("button",{class:`btn btn-sm btn-square px-2 ${e.isAsking?"loading":""}`,onClick:e.onNext},[n("i",{class:"gg-play-track-next transform "},null)])]),e.onClose?n("button",{class:"btn btn-sm btn-square",onClick:e.onClose},[n("i",{class:"gg-close"},null)]):null])}),vn=e=>{const t={[f.Spade]:"SPADE",[f.Heart]:"HEART",[f.Diamond]:"DIAMOND",[f.Club]:"CLUB"},s={3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11-JACK",12:"12-QUEEN",13:"13-KING",14:"1",16:"2",17:"JOKER-2",18:"JOKER-3"},r=()=>e.number===17||e.number===18?s[e.number]:`${t[e.color]}-${s[e.number]}`;return new URL({"../../assets/cards/CLUB-1.svg":is,"../../assets/cards/CLUB-10.svg":us,"../../assets/cards/CLUB-11-JACK.svg":cs,"../../assets/cards/CLUB-12-QUEEN.svg":ds,"../../assets/cards/CLUB-13-KING.svg":vs,"../../assets/cards/CLUB-2.svg":fs,"../../assets/cards/CLUB-3.svg":gs,"../../assets/cards/CLUB-4.svg":ms,"../../assets/cards/CLUB-5.svg":bs,"../../assets/cards/CLUB-6.svg":hs,"../../assets/cards/CLUB-7.svg":ps,"../../assets/cards/CLUB-8.svg":_s,"../../assets/cards/CLUB-9.svg":Cs,"../../assets/cards/DIAMOND-1.svg":ys,"../../assets/cards/DIAMOND-10.svg":As,"../../assets/cards/DIAMOND-11-JACK.svg":xs,"../../assets/cards/DIAMOND-12-QUEEN.svg":Ds,"../../assets/cards/DIAMOND-13-KING.svg":Fs,"../../assets/cards/DIAMOND-2.svg":Es,"../../assets/cards/DIAMOND-3.svg":ws,"../../assets/cards/DIAMOND-4.svg":ks,"../../assets/cards/DIAMOND-5.svg":Ns,"../../assets/cards/DIAMOND-6.svg":Bs,"../../assets/cards/DIAMOND-7.svg":Ss,"../../assets/cards/DIAMOND-8.svg":Ps,"../../assets/cards/DIAMOND-9.svg":Is,"../../assets/cards/HEART-1.svg":Os,"../../assets/cards/HEART-10.svg":Rs,"../../assets/cards/HEART-11-JACK.svg":Ms,"../../assets/cards/HEART-12-QUEEN.svg":Ts,"../../assets/cards/HEART-13-KING.svg":$s,"../../assets/cards/HEART-2.svg":Hs,"../../assets/cards/HEART-3.svg":Ls,"../../assets/cards/HEART-4.svg":Gs,"../../assets/cards/HEART-5.svg":Us,"../../assets/cards/HEART-6.svg":Ks,"../../assets/cards/HEART-7.svg":js,"../../assets/cards/HEART-8.svg":Js,"../../assets/cards/HEART-9.svg":qs,"../../assets/cards/JOKER-1.svg":zs,"../../assets/cards/JOKER-2.svg":Qs,"../../assets/cards/JOKER-3.svg":Vs,"../../assets/cards/SPADE-1.svg":Ws,"../../assets/cards/SPADE-10.svg":Xs,"../../assets/cards/SPADE-11-JACK.svg":Ys,"../../assets/cards/SPADE-12-QUEEN.svg":Zs,"../../assets/cards/SPADE-13-KING.svg":en,"../../assets/cards/SPADE-2.svg":tn,"../../assets/cards/SPADE-3.svg":sn,"../../assets/cards/SPADE-4.svg":nn,"../../assets/cards/SPADE-5.svg":an,"../../assets/cards/SPADE-6.svg":rn,"../../assets/cards/SPADE-7.svg":ln,"../../assets/cards/SPADE-8.svg":on,"../../assets/cards/SPADE-9.svg":un}[`../../assets/cards/${r()}.svg`],self.location).href},fn=p({props:{card:{required:!0,type:Object}},setup:e=>()=>n("div",{class:"absolute",style:"aspect-ratio: 3/4"},[n("img",{style:"border: 1px solid rgba(0,0,0,0.5)",class:"rounded bordered absolute top-0 left-0 right-0 bottom-0 h-full pointer-events-none select-none",src:vn(e.card)},null)])});var L;(function(e){e[e.small=0]="small",e[e.big=1]="big"})(L||(L={}));const xe=p({props:{ishand:Boolean,selectIdxs:Set,onSelectIdxs:Function,size:Number,cards:{type:Array,required:!0}},setup:e=>{const t=_(),s=_(),r=i=>{t.value=i,s.value=i},a=i=>s.value=i,l=A(()=>{const i=s.value,u=t.value;return i==null||u===void 0?[]:[...e.cards.keys()].slice(Math.min(i,u),Math.max(i,u)+1)}),o=()=>{var i;(i=e.onSelectIdxs)==null||i.call(e,l.value),t.value=void 0,s.value=void 0};return document.addEventListener("mouseup",o),mt(()=>document.removeEventListener("mouseup",o)),()=>{const i=()=>{const u=[];return e.size===L.small?u.push("w-3 h-20 relative"):u.push("w-4 h-28 relative"),e.ishand?u.push("pointer-events-auto"):u.push("pointer-events-none"),u};return e.cards===void 0?n("div",null,[g("PASS!")]):n("div",{class:"flex pointer-events-auto visible opacity-100 pr-14 overflow-visible"},[e.cards.sort((u,d)=>d.number-u.number).map((u,d)=>{var c;return n("div",{onMousedown:()=>r==null?void 0:r(d),onMousemove:()=>a==null?void 0:a(d),key:be(u),class:i()},[n(fn,{card:u,class:`absolute left-0 top-0 bottom-0 select-none transform ${(l==null?void 0:l.value.includes(d))?"scale-95":""} ${((c=e.selectIdxs)==null?void 0:c.has(d))?" -translate-y-2":""}`},null)])})])}}}),gn=p({props:{game:{type:Object,required:!0}},setup:e=>{const t=_(),s=()=>{t.value&&t.value.scrollTo({top:t.value.scrollHeight,behavior:"smooth"})};return we(s),bt(s),()=>{const r=e.game.tricks.slice().sort((a,l)=>a.idx-l.idx);return n("div",{ref:t,class:"mockup-code w-1/3 gap-2 flex flex-col m-3 overflow-auto relative"},[r.map(a=>n(P,null,[n("pre",{key:a.idx,"data-prefix":"$",class:"bg-success text-neutral"},[n("code",null,[g("\u7B2C"),a.idx+1,g("\u56DE\u5408")])]),a.tricks.slice().sort((l,o)=>l.createTime-o.createTime).map(l=>n("pre",{key:l.createTime,"data-prefix":l.player.nikeName},[n("span",{class:"float-right mr-3 text-base-300 opacity-40"},[l.createTime]),l.cards?n(xe,{size:L.small,cards:l.cards},null):n("span",null,[g("\u8FC7")])]))]))])}}}),mn=p({props:{game:{type:Object,required:!0},index:{type:Number,required:!0}},setup:e=>{const t=_(new Set),{gameRef:s,moveCursor:r,manualPlay:a,isAsking:l}=Ae(e.game),o=A(()=>ls(s.value)[e.index]),i=A(()=>{const x=ne(s.value).id===o.value.id;return x===!1&&t.value.clear(),x});let u=0;ht(()=>{s.value.championer===void 0&&i.value===!0&&k(o.value)&&a(o.value),u=0});const d=x=>{for(const F of x)t.value.has(F)?t.value.delete(F):t.value.add(F)},c=A(()=>M(s.value)!==void 0),v=A(()=>m.value.length>0),m=A(()=>st(s.value)),C=A(()=>{var x;return((x=s.value.championer)==null?void 0:x.id)===o.value.id}),D=A(()=>s.value.championer!==void 0),N=()=>{if(m.value.length===0)return;t.value.clear();const x=m.value[u%m.value.length].cards.map(F=>o.value.leftCards.findIndex(ae=>J(F,ae)));d(x),u++},lt=()=>{const x=[...t.value].map(F=>o.value.leftCards[F]);try{a(o.value,x)}catch{}};return()=>{const x=()=>{if(D.value===!0)return null;const B=o.value.lastTrick;return B&&i.value===!1?B.cards?n(xe,{cards:B.cards,size:L.small},null):n("span",null,[g("\u8981\u4E0D\u8D77")]):null},F=()=>{if(D.value===!0)return C.value===!0?n("span",{class:"text-3xl"},[g("\u{1F389}\u{1F389}\u83B7\u80DC\u{1F389}\u{1F389}")]):null;if(s.value.autoStart===!0)return i.value===!0?n("span",null,[g("\u7B49\u5F85\u51FA\u724C...")]):null;if(i.value)return n(P,null,[n("button",{"data-tip":"\u66FF\u6362\u539F\u6709\u7528\u6237\u903B\u8F91\u51FA\u724C",class:"btn btn-sm tooltip",disabled:t.value.size===0,onClick:lt},[g("\u624B\u52A8\u51FA\u724C")]),n("button",{"data-tip":"\u4E0D\u51FA\u724C\u3002\u5FC5\u987B\u51FA\u724C\u65F6\u6309\u94AE\u4E0D\u53EF\u7528",class:"btn btn-sm tooltip",disabled:!c.value,onClick:()=>a(o.value)},[g("\u8FC7")]),n("button",{"data-tip":"\u63D0\u793A\u5F53\u524D\u53EF\u4EE5\u51FA\u7684\u5361\u7EC4\uFF0C\u591A\u6B21\u70B9\u51FB\u53EF\u5207\u6362\u63D0\u793A\u3002\u5982\u6B64\u65F6\u65E0\u53EF\u7528\u724C\uFF0C\u6309\u94AE\u4E0D\u53EF\u7528",class:"btn btn-sm tooltip",disabled:!v.value,onClick:N},[g("\u63D0\u793A")]),n("button",{"data-tip":"\u6309\u7167\u7528\u6237\u6709\u903B\u8F91\u51FA\u724C",class:`btn btn-sm tooltip ${l.value?"loading":""}`,onClick:r},[g("\u81EA\u52A8\u51FA\u724C")])])},ae=e.index===2?"flex-col-reverse":"flex-col",ot=()=>{let B="";return e.index===0?B="top-20 left-16":e.index===1?B="top-20 right-16":B="bottom-20 left-16",n("div",{class:`absolute transform ${B} flex flex-col items-center space-y-2 tooltip`,"data-tip":o.value.nikeName},[n("div",{class:"avatar placeholder"},[n("div",{class:"bg-neutral-focus text-neutral-content rounded-full w-16 h-16"},[n("span",null,[ge(o.value)])])])])};return n("div",{class:`flex items-center relative justify-center ${ae}`},[ot(),n("div",{class:"space-x-2 h-1/3 flex items-center"},[F()]),n("div",{class:"h-1/3 flex items-center"},[n(xe,{onSelectIdxs:d,selectIdxs:t.value,cards:D.value?o.value.cards:o.value.leftCards,ishand:i.value},null)]),n("div",{class:"h-1/3 flex items-center"},[x()])])}}}),bn=p({props:{onClose:Function,game:{type:Object,required:!0}},setup:e=>{const t=_(!1),{gameRef:s,moveCursor:r,toggle:a,isAsking:l,trashTricks:o,cancelTrick:i}=Ae(Ne(e.game)),u=A(()=>s.value.championer!==void 0),d=A(()=>s.value.tricks.length>0);return()=>n("div",{class:"modal visible opacity-100 pointer-events-auto"},[n("div",{class:"absolute top-0 right-0 bottom-0 w-3/4 flex",style:"background-color: #45a173;"},[t.value?n(gn,{game:s.value},null):null,n("div",{class:"grid grid-cols-2 grid-rows-2 flex-1"},[s.value.players.map((c,v)=>n(mn,{key:c.id,game:s.value,index:v,class:`${v==2?"col-span-2":""}`},null))]),n(cn,{isCanCancel:d.value,onCancel:i,onTrash:o,onClose:e.onClose,isAsking:l.value,class:"absolute bottom-4 right-2",isFinish:u.value,isPlaying:s.value.autoStart,onToggle:a,onNext:r},null),n("button",{class:"btn btn-circle btn absolute right-3 top-10",onClick:()=>t.value=!t.value},[n("i",{class:"gg-menu-boxed"},null)])])])}}),hn=e=>{const t=he({component:n(bn,{game:e,onClose:()=>t()},null)})},pn=e=>{if(e)return At(e)},rt=e=>{var t;return(t=e.players.find(s=>k(s)))==null?void 0:t.cards.slice().sort((s,r)=>s.number-r.number).map(s=>s.number.toString(32)).join("")},De=e=>{var t;return(t=rt(e))!=null?t:""},_n=p({props:{game:{type:Object,required:!0}},setup:e=>{const{gameRef:t,moveCursor:s,toggle:r,isAsking:a}=Ae(Ne(e.game));return()=>{var u;const l=t.value.championer!==void 0,o=rt(t.value),i=pn(o);return n("div",{class:"card shadow-lg compact side bg-base-100"},[n("div",{class:"flex-row items-center space-x-4 card-body"},[n("div",{class:"flex-1"},[l?n("h2",{class:"card-title text-neutral"},[g("\u5B8C\u6210")]):n("h2",{class:"card-title text-info"},[g("\u8FDB\u884C\u4E2D")]),n("p",{class:"text-base-content text-opacity-40 font-mono"},[t.value.id]),n("p",null,[t.value.players.filter(d=>!k(d)).map(d=>d.nikeName).join(","),n("span",{class:"text-red-400"},[g("\u80DC\u5229\u8005:"),(u=t.value.championer)==null?void 0:u.nikeName])])]),t.value.__isOnline?n("span",{class:"font-bold absolute top-2 right-3",style:{color:i}},[g("GID:"),o]):null,n("div",{class:"flex space-x-2 flex-0"},[n(dn,{onGoDetail:()=>hn(t.value),isAsking:a.value,isFinish:l,isPlaying:t.value.autoStart,onToggle:r,onNext:s},null)])])])}}});var Cn=p(()=>{const{games:e}=z();return()=>{const t=Object.entries(G.exports.groupBy(e.value,s=>De(s))).filter(([s,r])=>r.every(a=>{var l,o;return((l=a.championer)==null?void 0:l.id)===((o=r[0].championer)==null?void 0:o.id)}));return n(P,null,[n("div",{class:"card shadow-lg compact side bg-base-100"},[t.map(([s,r])=>{var a;return n("span",null,[s,g(" - "),(a=r[0].championer)==null?void 0:a.nikeName])})]),n("div",{class:"grid grid-rows-1 grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-8 py-4"},[e.value.slice().sort((s,r)=>De(s).localeCompare(De(r))).map(s=>n(_n,{game:s,key:s.id},null))])])}});const yn=p({props:{player:{required:!0,type:Object}},setup:e=>{const{games:t}=z(),s=A(()=>t.value.filter(a=>a.players.find(l=>Te(l,e.player))!==void 0).length),r=A(()=>t.value.filter(a=>Te(a.championer,e.player)).length);return()=>{var a;return n("div",{class:"card shadow-lg compact side bg-base-100 px-4 py-3"},[n("div",{class:"flex flex-col"},[n("div",{class:"flex mb-3 content-between justify-between"},[n("div",{class:"flex flex-col items-center"},[n("span",{class:"text-xs text-gray-500"},[g("\u53C2\u4E0E\u5BF9\u6218")]),n("span",{class:"text-sm font-mono font-black"},[s.value])]),n("div",{class:"avatar placeholder"},[n("div",{class:"bg-neutral-focus text-neutral-content rounded-full w-10 h-10"},[n("span",null,[ge(e.player)])])]),n("div",{class:"flex flex-col items-center"},[n("span",{class:"text-xs text-gray-500"},[g("\u83B7\u5F97\u80DC\u5229")]),n("span",{class:"text-sm font-mono font-black"},[r.value])])]),n("div",{class:"flex flex-col items-center"},[n("span",{class:"text-neutral-focus text-base font-black"},[(a=e.player.nikeName)!=null?a:"\u65E0\u540D\u4E4B\u8F88"]),n("span",{class:"text-xs text-gray-500 font-serif"},[e.player.host])])])])}}});var An=p({setup:()=>{const{players:e}=fe();return()=>n("div",{class:"grid grid-rows-1 grid-cols-1 lg:grid-cols-2 xl:grid-cols-6 gap-3"},[e.value.filter(t=>!ce(t)).map(t=>n(yn,{player:t},null))])}}),xn=p(()=>()=>n("div",{class:"flex flex-col flex-1 bg-base-200 mt-16 pt-10 pr-5 pl-5 gap-5"},[n(An,null,null),n(Cn,null,null)])),Dn=p(()=>()=>n("div",{class:"h-full w-full absolute flex flex-col"},[n(Rt,null,null),n(xn,null,null),n(Mt,null,null)]));ke(Dn).mount("#app");
